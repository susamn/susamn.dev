---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Timeline from '../components/Timeline.astro';

const latestPosts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 4);

const projects = (await getCollection('projects'))
	.filter((project) => project.data.featured)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);

const startDate = new Date('2010-06-01');
const today = new Date();
const experienceYears = Math.floor((today.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24 * 365.25));
---

<Layout title="Supratim Samanta | Senior Software Engineer">
	<!-- Hero Section - Integrated card layout -->
	<section class="relative mb-12">
		<div class="bg-gradient-to-br from-stone-100 via-stone-50 to-amber-50/30 rounded-2xl p-6 md:p-10 border border-stone-200/60">
			<div class="flex flex-col md:flex-row gap-8 items-start">
				<!-- Profile & Identity -->
				<div class="flex items-start gap-5 flex-1">
					<div class="relative shrink-0">
						<div class="absolute -inset-1 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full opacity-20 blur-sm"></div>
						<img
							src="/profile.jpg"
							alt="Supratim Samanta"
							class="relative w-20 h-20 md:w-24 md:h-24 rounded-full object-cover border-2 border-white shadow-md"
						/>
					</div>
					<div class="pt-1">
						<h1 class="font-['Fraunces',_serif] text-2xl md:text-3xl font-semibold text-stone-900 leading-tight mb-2">
							Supratim Samanta
						</h1>
						<p class="text-stone-500 font-medium text-sm md:text-base">Senior Software Engineer</p>
						<div class="flex items-center gap-4 mt-3">
							<a href="https://github.com/susamn" class="text-stone-400 hover:text-stone-700 transition-colors" aria-label="GitHub">
								<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.11.81 2.235 0 1.62-.015 2.925-.015 3.315 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
							</a>
							<a href="https://www.linkedin.com/in/supratimsamanta/" class="text-stone-400 hover:text-blue-600 transition-colors" aria-label="LinkedIn">
								<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
							</a>
							<a href="https://x.com/supratimsamanta" class="text-stone-400 hover:text-stone-900 transition-colors" aria-label="X">
								<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
							</a>
						</div>
					</div>
				</div>

				<!-- Stats Badges -->
				<div class="flex flex-wrap gap-1.5 md:gap-2 md:justify-end md:max-w-[320px]">
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-teal-500"></span>
						<span class="text-xs font-semibold text-stone-700">{experienceYears}+ Yrs</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-rose-500"></span>
						<span class="text-xs text-stone-600">Parallel Systems</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-violet-500"></span>
						<span class="text-xs text-stone-600">Fullstack Development</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
						<span class="text-xs text-stone-600">Data Engineering</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-amber-500"></span>
						<span class="text-xs text-stone-600">Distributed Systems</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-cyan-500"></span>
						<span class="text-xs text-stone-600">Microservices</span>
					</div>
					<div class="inline-flex items-center gap-1.5 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-md border border-stone-200/80 shadow-sm">
						<span class="w-1.5 h-1.5 rounded-full bg-blue-500"></span>
						<span class="text-xs text-stone-600">Open Source</span>
					</div>
				</div>
			</div>

			<!-- Bio -->
			<p class="mt-6 text-stone-600 leading-relaxed max-w-3xl text-[15px]">
				Building tools and sharing knowledge. I specialize in distributed systems, cloud infrastructure,
				and data engineering. When I'm not coding, I write technical articles and launch experiments.
			</p>
		</div>
	</section>

	<!-- Experience Timeline -->
	<section class="mb-12">
		<div class="flex items-center gap-4 mb-4">
			<h2 class="font-['Fraunces',_serif] text-lg font-semibold text-stone-800">Experience Timeline</h2>
			<div class="flex-1 h-px bg-stone-200"></div>
		</div>
		<div class="bg-white rounded-xl border border-stone-200 p-4 md:p-6 overflow-visible">
			<Timeline />
		</div>
	</section>

	<!-- Main Content Grid - 3 column on desktop -->
	<div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8">

		<!-- Projects Column -->
		<section class="lg:col-span-5">
			<div class="flex items-center justify-between mb-5">
				<h2 class="font-['Fraunces',_serif] text-lg font-semibold text-stone-800">Projects</h2>
				<a href="/projects" class="text-xs font-medium text-amber-700 hover:text-amber-800 transition-colors uppercase tracking-wide">View all</a>
			</div>
			<div class="space-y-4">
				{projects.map((project, i) => (
					<a
						href={project.data.link || project.data.github}
						class="group block bg-white rounded-xl border border-stone-200 p-5 hover:border-amber-300 hover:shadow-md transition-all duration-200"
					>
						<div class="flex items-start justify-between gap-3">
							<div class="flex-1 min-w-0">
								<h3 class="font-semibold text-stone-900 group-hover:text-amber-700 transition-colors mb-1.5 truncate">
									{project.data.title}
								</h3>
								<p class="text-sm text-stone-500 leading-relaxed line-clamp-2">{project.data.description}</p>
							</div>
							<svg class="w-4 h-4 text-stone-300 group-hover:text-amber-500 shrink-0 mt-1 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
							</svg>
						</div>
						<div class="flex flex-wrap gap-2 mt-3">
							{project.data.tags.slice(0, 3).map(tag => (
								<span class="text-[11px] font-medium text-stone-400 bg-stone-100 px-2 py-0.5 rounded">
									{tag}
								</span>
							))}
						</div>
					</a>
				))}
				{projects.length === 0 && (
					<div class="bg-white rounded-xl border border-stone-200 p-6 text-center">
						<p class="text-stone-400 text-sm">No featured projects yet.</p>
					</div>
				)}
			</div>
		</section>

		<!-- Writing Column -->
		<section class="lg:col-span-7">
			<div class="flex items-center justify-between mb-5">
				<h2 class="font-['Fraunces',_serif] text-lg font-semibold text-stone-800">Latest Writing</h2>
				<a href="/blog" class="text-xs font-medium text-amber-700 hover:text-amber-800 transition-colors uppercase tracking-wide">Read all</a>
			</div>
			<div class="bg-white rounded-xl border border-stone-200 divide-y divide-stone-100">
				{latestPosts.map((post, i) => (
					<article class="group">
						<a href={`/blog/${post.slug}`} class="flex items-start gap-4 p-5 hover:bg-stone-50/50 transition-colors">
							<div class="shrink-0 w-14 text-center pt-0.5">
								<div class="text-2xl font-['Fraunces',_serif] font-semibold text-stone-300 group-hover:text-amber-400 transition-colors leading-none">
									{post.data.pubDate.toLocaleDateString('en-US', { day: '2-digit' })}
								</div>
								<div class="text-[10px] font-medium text-stone-400 uppercase tracking-wider mt-1">
									{post.data.pubDate.toLocaleDateString('en-US', { month: 'short' })}
								</div>
							</div>
							<div class="flex-1 min-w-0">
								<h3 class="font-semibold text-stone-900 group-hover:text-amber-700 transition-colors mb-1 leading-snug">
									{post.data.title}
								</h3>
								<p class="text-sm text-stone-500 leading-relaxed line-clamp-2">{post.data.description}</p>
							</div>
							<svg class="w-4 h-4 text-stone-300 group-hover:text-amber-500 shrink-0 mt-1 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
							</svg>
						</a>
					</article>
				))}
			</div>
		</section>
	</div>

	<!-- Tech Stack Footer -->
	<section class="mt-12 pt-8 border-t border-stone-200">
		<div class="flex flex-wrap items-center justify-center gap-x-8 gap-y-3 text-sm text-stone-400">
			<span class="font-medium text-stone-500">Primary Stack:</span>
			<span>Java</span>
			<span class="text-stone-300">|</span>
			<span>Python</span>
			<span class="text-stone-300">|</span>
			<span>Go</span>
			<span class="text-stone-300">|</span>
			<span>AWS</span>
			<span class="text-stone-300">|</span>
			<span>Kubernetes</span>
		</div>
	</section>
</Layout>
